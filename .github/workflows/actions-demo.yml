on: [push, workflow_dispatch]
jobs:
  build:
    name: Greeting
    runs-on: windows-2016
    steps:
    - uses: actions/checkout@v2
    - name: Run a multi-line script
      shell: cmd
      run: |
        netsh advfirewall set allprofiles state off
        mkdir logs
        type NUL > logs\lhps.log
        START /B web.exe > logs\lhps.log
        netstat -aon
        tasklist
    - name: Install dependencies
      run: |
          curl localhost:8090/hello
    - uses: actions/upload-artifact@v2
      if: ${{ always() }}
      with:
        name: logs
        path: logs\*.log